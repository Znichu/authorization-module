(this["webpackJsonpauthorization-module"]=this["webpackJsonpauthorization-module"]||[]).push([[0],{142:function(e,t,a){e.exports=a(223)},147:function(e,t,a){},148:function(e,t,a){},223:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(10),o=a.n(s),c=(a(147),a(148),a(149),a(224)),i=a(32);function l(){return r.createElement(c.a,{mode:"horizontal"},r.createElement(c.a.Item,{key:"profile"},r.createElement(i.c,{to:"/profile"},"Profile")),r.createElement(c.a.Item,{key:"sign-in"},r.createElement(i.c,{to:"/sign-in"},"Sign-in")),r.createElement(c.a.Item,{key:"forgot"},r.createElement(i.c,{to:"/packs"},"Packs")),r.createElement(c.a.Item,{key:"set-new-pass"},r.createElement(i.c,{to:"/cards"},"Cards")))}var u=a(23),m=function(e){return n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("h3",null,"Profile")),n.a.createElement("button",null,"Logout"))},d=a(20),p=a(52),g=a(226),E=a(228),f=a(100),h=a(31),_=a(4),b=a.n(_),w=a(14),v=a(28),S=a(50),O=a.n(S),P=O.a.create({baseURL:"https://cards-nya-back.herokuapp.com/1.0/"}),y=function(e,t,a){return P.post("auth/login",{email:e,password:t,rememberMe:a}).then((function(e){return e.data}))},k=function(e){return P.post("auth/me",{token:e}).then((function(e){return e.data}))},T=a(123),C=a(124),R=new(a(140).a),N=new(function(){function e(){Object(T.a)(this,e)}return Object(C.a)(e,[{key:"get",value:function(e){return R.get(e)}},{key:"set",value:function(e,t){R.set(e,t)}},{key:"remove",value:function(e){R.remove(e)}}]),e}()),I={_id:null,email:null,name:null,isAdmin:null,publicCardPacksCount:null,isAuth:!1},j=function(e,t,a,r,n,s){return{type:"AUTH/SET_AUTH_DATA",payload:{_id:e,email:t,name:a,isAdmin:r,publicCardPacksCount:n,isAuth:s}}},A=function(){return function(){var e=Object(w.a)(b.a.mark((function e(t){var a,r,n,s,o,c,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=N.get("auth_token"),e.next=4,k(a);case 4:r=e.sent,N.set("auth_token",r.token),n=r._id,s=r.email,o=r.name,c=r.isAdmin,i=r.publicCardPacksCount,t(j(n,s,o,c,i,!0)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},G={_id:null,email:null,success:!1,isFetching:!1,errorMessage:""},F=function(e,t,a){return{type:"SIGNIN/SET_USER_DATA",payload:{_id:e,email:t,success:a}}},x=function(e){return{type:"SIGNIN/SET_MESSAGE_ERROR",errorMessage:e}},U=function(e){return{type:"SIGNIN/TOGGLE_IS_FETCHING",isFetching:e}},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGNIN/SET_USER_DATA":return Object(v.a)({},e,{},t.payload);case"SIGNIN/TOGGLE_IS_FETCHING":return Object(v.a)({},e,{isFetching:t.isFetching});case"SIGNIN/SET_MESSAGE_ERROR":return Object(v.a)({},e,{errorMessage:t.errorMessage});default:return e}},L=a(96),H=a.n(L),D=a(37),q=D.a().shape({email:D.b().required().min(2),password:D.b().required().min(8)}),W=D.a().shape({email:D.b().email().required().min(7),password:D.b().required().min(8),passwordConfirmation:D.b().required().label("Confirm password").test("passwordConfirmation","Passwords must match!",(function(e){return this.parent.password===e}))}),z=D.a().shape({email:D.b().email().required()}),J=D.a().shape({password:D.b().required().min(8),passwordConfirmation:D.b().required().test("passwordConfirmation","Passwords must match!",(function(e){return this.parent.password===e}))}),B=function(){var e=Object(h.b)(),t=Object(d.d)({resolver:Object(p.a)(q)}),a=t.register,r=t.handleSubmit,s=t.errors,o=t.control,c=t.reset,l=Object(h.c)((function(e){return e.auth.isAuth})),m=Object(h.c)((function(e){return e.singInReducer})),_=m.isFetching;m.errorMessage;return l?n.a.createElement(u.a,{to:"/profile"}):n.a.createElement("div",{className:H.a.signInPage},n.a.createElement("div",null,n.a.createElement("h3",null,"SignIn")),n.a.createElement("form",{onSubmit:r((function(t){var a=t.email,r=t.password,n=t.rememberMe;e(function(e,t,a){return function(){var r=Object(w.a)(b.a.mark((function r(n){var s;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n(U(!0)),n(x("")),r.next=5,y(e,t,a);case 5:s=r.sent,N.set("auth_token",s.token),n(F(s._id,s.email,s.success)),n(A()),r.next=15;break;case 11:r.prev=11,r.t0=r.catch(0),n(x(r.t0.response.data.error)),console.log(r.t0.message);case 15:n(U(!1));case 16:case"end":return r.stop()}}),r,null,[[0,11]])})));return function(e){return r.apply(this,arguments)}}()}(a,r,n))})),className:H.a.signInPage__form},n.a.createElement("div",null,n.a.createElement(d.a,{as:g.a,name:"email",control:o,placeholder:"Email"}),s.email&&n.a.createElement(E.a,{message:"Login is required",type:"error",showIcon:!0})),n.a.createElement("div",null,n.a.createElement(d.a,{as:g.a.Password,name:"password",control:o,placeholder:"Password"}),s.password&&n.a.createElement(E.a,{message:"Password is required",type:"error",showIcon:!0})),n.a.createElement(i.b,{to:"/forgot"},"Forgot your password?"),n.a.createElement("div",null,n.a.createElement("input",{type:"checkbox",name:"rememberMe",ref:a})," Remember me"),n.a.createElement(f.a,{onClick:function(){return c()},loading:_,htmlType:"submit",type:"primary"},"Sign In")),n.a.createElement("span",null,"or"),n.a.createElement(i.b,{to:"/register"},"Registration"))},K=O.a.create({baseURL:"https://cards-nya-back.herokuapp.com/1.0/"}),X=function(e,t){return K.post("auth/register",{email:e,password:t}).then((function(e){return e.data}))},V="authorization-module-project/registerReducer/SET_USER_DATA_SUCCESS",Y={addedUser:{created:null,email:null,isAdmin:!1,name:null,publicCardPacksCount:null,rememberMe:!1,updated:null,verified:!1,__v:null,_id:null},success:!1},Q=function(e){return{type:V,payload:Object(v.a)({},e)}},Z=a(99),$=a.n(Z),ee=function(){var e,t,a,s=Object(h.c)((function(e){return e.register.success})),o=Object(h.b)(),c=Object(d.d)({resolver:Object(p.a)(W)}),l=c.handleSubmit,m=c.errors,E=c.control,_=c.reset,v=Object(r.useCallback)((function(e,t){return o(function(e,t){return function(){var a=Object(w.a)(b.a.mark((function a(r){var n;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,X(e,t);case 3:n=a.sent,r(Q(n)),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(a.t0);case 10:case"end":return a.stop()}}),a,null,[[0,7]])})));return function(e){return a.apply(this,arguments)}}()}(e,t))}),[o]);return s?n.a.createElement(u.a,{to:"/sign-in"}):n.a.createElement("div",{className:$.a.registerPage},n.a.createElement("div",null,n.a.createElement("h3",null,"Registration")),n.a.createElement("form",{onSubmit:l((function(e){v(e.email,e.password)})),className:$.a.registerPage__form},n.a.createElement(d.a,{as:g.a,name:"email",control:E,placeholder:"Email"}),n.a.createElement("p",null,null===(e=m.email)||void 0===e?void 0:e.message),n.a.createElement(d.a,{as:g.a.Password,name:"password",type:"password",control:E,placeholder:"Password"}),n.a.createElement("p",null,null===(t=m.password)||void 0===t?void 0:t.message),n.a.createElement(d.a,{as:g.a.Password,type:"password",name:"passwordConfirmation",control:E,placeholder:"Confirm password"}),n.a.createElement("p",null,null===(a=m.passwordConfirmation)||void 0===a?void 0:a.message),n.a.createElement(f.a,{onClick:function(){return _()},htmlType:"submit",type:"primary"},"Register")),n.a.createElement(i.b,{to:"/sign-in"},"Sign In"))},te=a(86),ae=a.n(te),re=O.a.create({baseURL:"https://cards-nya-back.herokuapp.com/1.0/"}),ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"<a href='http://localhost:3000/authorization-module#/set-new-password'",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:">reset-password-link</a>";return re.post("/auth/forgot",{email:e,html1:t,html2:a}).then((function(e){return e.data}))},se={success:!1,errorMessage:"",isFetching:!1},oe=function(e){return{type:"FORGOTPAGE/CHANGE_PASSWORD_SUCCESS",success:e}},ce=function(e){return{type:"FORGOTPAGE/CHANGE_PASSWORD_ERROR",errorMessage:e}},ie=function(e){return{type:"FORGOTPAGE/TOGGLE_IS_FETCHING",isFetching:e}},le=a(227);function ue(){return n.a.createElement(le.a,{status:"success",title:"Check your email",subTitle:"We've sent an email to ... . Click the link in the email to reset your password\r If you don't see the email, check other places it might be, like your junk, social, spam, or other folders."})}var me=function(){var e,t=Object(d.d)({resolver:Object(p.a)(z)}),a=t.handleSubmit,s=t.errors,o=t.control,c=t.reset,l=Object(h.c)((function(e){return e.forgotPage})),u=l.errorMessage,m=l.isFetching,_=l.success,v=Object(h.b)(),S=Object(r.useCallback)((function(e){return v((t=e,function(){var e=Object(w.a)(b.a.mark((function e(a){var r,n,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a(ie(!0)),a(ce("")),e.next=5,ne(t);case 5:r=e.sent,n=r.html.match(/(.*)set-new-password'(.*?)>(.*)/),s=n[2],N.set("resetPasswordToken",s),a(oe(r.success)),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),a(ce(e.t0.response.data.error)),console.log(e.t0.message);case 16:a(ie(!1));case 17:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}()));var t}),[v]);return console.log("Render Forgot"),_?n.a.createElement(ue,null):n.a.createElement("div",{className:ae.a.forgotPage},u&&n.a.createElement(E.a,{message:u,type:"warning",showIcon:!0}),n.a.createElement("h3",null,"Forgot password?"),n.a.createElement("span",null,"Please enter ",n.a.createElement("b",null,"email")," that you used to sign in"),n.a.createElement("form",{className:ae.a.forgotForm,onSubmit:a((function(e){S(e.email)}))},n.a.createElement("div",{className:ae.a.error},s.email?n.a.createElement(E.a,{message:null===(e=s.email)||void 0===e?void 0:e.message,type:"error",showIcon:!0}):null),n.a.createElement(d.a,{as:g.a,name:"email",control:o,placeholder:"Email"}),n.a.createElement(f.a,{onClick:function(){return c()},loading:m,htmlType:"submit",type:"primary"},"Send email")),n.a.createElement(i.b,{to:"/sign-in"},"Sign In"))},de=a(87),pe=a.n(de),ge=O.a.create({baseURL:"https://cards-nya-back.herokuapp.com/1.0/"}),Ee=function(e,t){return ge.post("/auth/set-new-password",{resetPasswordToken:e,password:t}).then((function(e){return e.data}))},fe={success:!1,errorMessage:"",isFetching:!1},he=function(e){return{type:"RESET/SET_NEW_PASS_SUCCESS",success:e}},_e=function(e){return{type:"RESET/SET_NEW_PASS_ERROR",message:e}},be=function(e){return{type:"RESET/TOGGLE_IS_FETCHING",isFetching:e}},we=function(){var e,t,a=Object(d.d)({resolver:Object(p.a)(J)}),s=a.handleSubmit,o=a.errors,c=a.control,i=a.reset,l=Object(h.c)((function(e){return e.restPass})),m=l.success,E=l.isFetching,_=Object(h.b)(),v=Object(r.useCallback)((function(e){return _((t=e,function(){var e=Object(w.a)(b.a.mark((function e(a){var r,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a(be(!0)),r=N.get("resetPasswordToken"),e.next=5,Ee(r,t);case 5:n=e.sent,a(he(n)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),a(_e(e.t0.response.data.error)),console.log(e.t0.message);case 13:a(be(!1));case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()));var t}),[_]);return m?n.a.createElement(u.a,{to:"/sign-in"}):n.a.createElement("div",{className:pe.a.setNewPassPage},n.a.createElement("div",{className:pe.a.setNewPassPage__info},n.a.createElement("h3",null,"Choose a New Password"),n.a.createElement("span",null,"Create a new password that is at least 8 characters long")),n.a.createElement("form",{onSubmit:s((function(e){v(e.password)})),className:pe.a.setNewPassPage__form},n.a.createElement(d.a,{as:g.a.Password,name:"password",type:"password",control:c,placeholder:"Password"}),n.a.createElement("p",null,null===(e=o.password)||void 0===e?void 0:e.message),n.a.createElement(d.a,{as:g.a.Password,type:"password",name:"passwordConfirmation",control:c,placeholder:"Confirm password"}),n.a.createElement("p",null,null===(t=o.passwordConfirmation)||void 0===t?void 0:t.message),n.a.createElement(f.a,{onClick:function(){return i()},loading:E,htmlType:"submit",type:"primary"},"Continue")))};var ve=function(){var e=Object(h.b)();return Object(r.useEffect)((function(){e(A())})),n.a.createElement("div",{className:"main"},n.a.createElement(l,null),n.a.createElement(u.d,null,n.a.createElement(u.b,{path:"/profile",render:function(){return n.a.createElement(m,null)}}),n.a.createElement(u.b,{path:"/sign-in",render:function(){return n.a.createElement(B,null)}}),n.a.createElement(u.b,{path:"/register",render:function(){return n.a.createElement(ee,null)}}),n.a.createElement(u.b,{path:"/forgot",render:function(){return n.a.createElement(me,null)}}),n.a.createElement(u.b,{path:"/set-new-password",render:function(){return n.a.createElement(we,null)}})))},Se=a(69),Oe=a(138),Pe=Object(Se.c)({forgotPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FORGOTPAGE/CHANGE_PASSWORD_SUCCESS":return Object(v.a)({},e,{success:t.success});case"FORGOTPAGE/CHANGE_PASSWORD_ERROR":return Object(v.a)({},e,{errorMessage:t.errorMessage});case"FORGOTPAGE/TOGGLE_IS_FETCHING":return Object(v.a)({},e,{isFetching:t.isFetching});default:return e}},register:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case V:return Object(v.a)({},e,{addedUser:Object(v.a)({},t.payload.addedUser),success:t.payload.success});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH/SET_AUTH_DATA":return Object(v.a)({},e,{},t.payload);default:return e}},restPass:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RESET/SET_NEW_PASS_SUCCESS":return Object(v.a)({},e,{success:t.success});case"RESET/SET_NEW_PASS_ERROR":return Object(v.a)({},e,{errorMessage:t.message});case"RESET/TOGGLE_IS_FETCHING":return Object(v.a)({},e,{isFetching:t.isFetching});default:return e}},singInReducer:M}),ye=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__,ke=Object(Se.d)(Pe,ye(Object(Se.a)(Oe.a)));o.a.render(n.a.createElement(i.a,null,n.a.createElement(h.a,{store:ke},n.a.createElement(ve,null))),document.getElementById("root"))},86:function(e,t,a){e.exports={forgotPage:"Forgot_forgotPage__neKLE",error:"Forgot_error__BLT2U",forgotForm:"Forgot_forgotForm__UfYTJ"}},87:function(e,t,a){e.exports={setNewPassPage:"SetNewPass_setNewPassPage__3smxh",setNewPassPage__info:"SetNewPass_setNewPassPage__info__DRlit",setNewPassPage__form:"SetNewPass_setNewPassPage__form__21O7x"}},96:function(e,t,a){e.exports={signInPage:"SignIn_signInPage__WFi5q",signInPage__form:"SignIn_signInPage__form__1tCuA"}},99:function(e,t,a){e.exports={registerPage:"Register_registerPage__5npDg",registerPage__form:"Register_registerPage__form__2krKA"}}},[[142,1,2]]]);
//# sourceMappingURL=main.d2dbe942.chunk.js.map